{
  "version": 4,
  "terraform_version": "1.13.3",
  "serial": 6,
  "lineage": "8208dcb1-3377-fd80-6e56-de4dfcee7a8f",
  "outputs": {
    "enforcement_mode": {
      "value": "Default",
      "type": "string"
    },
    "subscription_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e",
      "type": "string"
    },
    "vm_encryption_assignment_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyAssignments/vm-encryption-required",
      "type": "string"
    },
    "vm_encryption_policy_definition_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyDefinitions/custom-vm-encryption-required",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NGI1NWQxNGEtNjYwNy00YTU2LTg2MTUtOWM5NTU1NjFkYTgwO3N1YnNjcmlwdGlvbklkPThjNzgxZjVjLWI0YzktNDE4NC05OTE1LTdiYjNiNjRhODg1ZTt0ZW5hbnRJZD05ZjBmZTAyZC00MDY4LTQzMDctYTVkYS02OTdiNjA1OGZhNjQ=",
            "object_id": "4b55d14a-6607-4a56-8615-9c955561da80",
            "subscription_id": "8c781f5c-b4c9-4184-9915-7bb3b64a885e",
            "tenant_id": "9f0fe02d-4068-4307-a5da-697b6058fa64",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "vm_encryption_required",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "This policy denies the creation of virtual machines that do not have EncryptionAtHost enabled",
            "display_name": "Virtual Machines must have EncryptionAtHost enabled",
            "id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyDefinitions/custom-vm-encryption-required",
            "management_group_id": "",
            "metadata": "{\"category\":\"Security\",\"createdBy\":\"4b55d14a-6607-4a56-8615-9c955561da80\",\"createdOn\":\"2025-10-19T19:42:32.0957022Z\",\"source\":\"Terraform\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "Indexed",
            "name": "custom-vm-encryption-required",
            "parameters": "",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Compute/virtualMachines\",\"field\":\"type\"},{\"anyOf\":[{\"exists\":\"false\",\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.encryptionAtHost\"},{\"field\":\"Microsoft.Compute/virtualMachines/securityProfile.encryptionAtHost\",\"notEquals\":true}]}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "vm_encryption_required",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "Denies creation of virtual machines without EncryptionAtHost enabled. Applies to both Windows and Linux VMs.",
            "display_name": "Require EncryptionAtHost on all Virtual Machines",
            "enforce": true,
            "id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyAssignments/vm-encryption-required",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "557d6dac-ccb4-4882-be89-c8d84b49efba",
                "tenant_id": "9f0fe02d-4068-4307-a5da-697b6058fa64",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "metadata": "{\"assignedBy\":\"Terraform - VM Encryption Policy\",\"category\":\"Security\",\"createdBy\":\"4b55d14a-6607-4a56-8615-9c955561da80\",\"createdOn\":\"2025-10-19T19:44:12.641287Z\",\"source\":\"Terraform\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "vm-encryption-required",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "",
            "policy_definition_id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyDefinitions/custom-vm-encryption-required",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_policy_definition.vm_encryption_required",
            "data.azurerm_client_config.current"
          ]
        }
      ]
    }
  ],
  "check_results": [
    {
      "object_kind": "var",
      "config_addr": "var.enforcement_mode",
      "status": "pass",
      "objects": [
        {
          "object_addr": "var.enforcement_mode",
          "status": "pass"
        }
      ]
    }
  ]
}
