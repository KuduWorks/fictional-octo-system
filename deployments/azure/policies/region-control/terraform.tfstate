{
  "version": 4,
  "terraform_version": "1.13.3",
  "serial": 5,
  "lineage": "d12ae6a9-6d70-e38e-da8c-768976020b73",
  "outputs": {
    "allowed_locations_policy_assignment_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyAssignments/allowed-regions-sweden-central-tf",
      "type": "string"
    },
    "allowed_locations_policy_assignment_name": {
      "value": "allowed-regions-sweden-central-tf",
      "type": "string"
    },
    "configured_allowed_regions": {
      "value": [
        "swedencentral"
      ],
      "type": [
        "list",
        "string"
      ]
    },
    "custom_resource_group_location_policy_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyDefinitions/custom-rg-location-policy",
      "type": "string"
    },
    "enforcement_mode": {
      "value": "Default",
      "type": "string"
    },
    "resource_group_location_policy_assignment_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyAssignments/rg-location-policy-assignment",
      "type": "string"
    },
    "subscription_id": {
      "value": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "azurerm_client_config",
      "name": "current",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "client_id": "04b07795-8ddb-461a-bbee-02f9e1bf7b46",
            "id": "Y2xpZW50Q29uZmlncy9jbGllbnRJZD0wNGIwNzc5NS04ZGRiLTQ2MWEtYmJlZS0wMmY5ZTFiZjdiNDY7b2JqZWN0SWQ9NGI1NWQxNGEtNjYwNy00YTU2LTg2MTUtOWM5NTU1NjFkYTgwO3N1YnNjcmlwdGlvbklkPThjNzgxZjVjLWI0YzktNDE4NC05OTE1LTdiYjNiNjRhODg1ZTt0ZW5hbnRJZD05ZjBmZTAyZC00MDY4LTQzMDctYTVkYS02OTdiNjA1OGZhNjQ=",
            "object_id": "4b55d14a-6607-4a56-8615-9c955561da80",
            "subscription_id": "8c781f5c-b4c9-4184-9915-7bb3b64a885e",
            "tenant_id": "9f0fe02d-4068-4307-a5da-697b6058fa64",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_policy_definition",
      "name": "custom_rg_location_policy",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "This policy ensures that resource groups are created only in approved Azure regions",
            "display_name": "Resource Groups must be in allowed locations",
            "id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyDefinitions/custom-rg-location-policy",
            "management_group_id": "",
            "metadata": "{\"category\":\"General\",\"createdBy\":\"4b55d14a-6607-4a56-8615-9c955561da80\",\"createdOn\":\"2025-10-19T18:26:01.1470854Z\",\"source\":\"Terraform\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "mode": "All",
            "name": "custom-rg-location-policy",
            "parameters": "{\"allowedLocations\":{\"type\":\"Array\",\"metadata\":{\"description\":\"The list of locations that resource groups can be created in\",\"displayName\":\"Allowed locations\",\"strongType\":\"location\"}}}",
            "policy_rule": "{\"if\":{\"allOf\":[{\"equals\":\"Microsoft.Resources/resourceGroups\",\"field\":\"type\"},{\"field\":\"location\",\"notIn\":\"[parameters('allowedLocations')]\"}]},\"then\":{\"effect\":\"deny\"}}",
            "policy_type": "Custom",
            "role_definition_ids": [],
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "allowed_locations_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "This policy restricts resource deployment to approved Azure regions (Sweden Central)",
            "display_name": "Allowed Regions Policy - Sweden Central (Terraform)",
            "enforce": true,
            "id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyAssignments/allowed-regions-sweden-central-tf",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "fef49520-1ab7-4f64-9cc0-93d7238dd531",
                "tenant_id": "9f0fe02d-4068-4307-a5da-697b6058fa64",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "metadata": "{\"category\":\"General\",\"createdBy\":\"4b55d14a-6607-4a56-8615-9c955561da80\",\"createdOn\":\"2025-10-19T18:26:03.2331505Z\",\"source\":\"Terraform\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "allowed-regions-sweden-central-tf",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"listOfAllowedLocations\":{\"value\":[\"swedencentral\"]}}",
            "policy_definition_id": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "data.azurerm_client_config.current"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "azurerm_subscription_policy_assignment",
      "name": "rg_location_assignment",
      "provider": "provider[\"registry.terraform.io/hashicorp/azurerm\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "description": "Ensures resource groups are created only in Sweden Central",
            "display_name": "Resource Group Location Control - Sweden Central",
            "enforce": true,
            "id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyAssignments/rg-location-policy-assignment",
            "identity": [
              {
                "identity_ids": null,
                "principal_id": "6c5fe3af-d412-4e56-9eac-4dbe1788a8c6",
                "tenant_id": "9f0fe02d-4068-4307-a5da-697b6058fa64",
                "type": "SystemAssigned"
              }
            ],
            "location": "swedencentral",
            "metadata": "{\"category\":\"General\",\"createdBy\":\"4b55d14a-6607-4a56-8615-9c955561da80\",\"createdOn\":\"2025-10-19T18:27:43.4326014Z\",\"source\":\"Terraform\",\"updatedBy\":null,\"updatedOn\":null,\"version\":\"1.0.0\"}",
            "name": "rg-location-policy-assignment",
            "non_compliance_message": [],
            "not_scopes": null,
            "overrides": [],
            "parameters": "{\"allowedLocations\":{\"value\":[\"swedencentral\"]}}",
            "policy_definition_id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e/providers/Microsoft.Authorization/policyDefinitions/custom-rg-location-policy",
            "resource_selectors": [],
            "subscription_id": "/subscriptions/8c781f5c-b4c9-4184-9915-7bb3b64a885e",
            "timeouts": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjoxODAwMDAwMDAwMDAwLCJkZWxldGUiOjE4MDAwMDAwMDAwMDAsInJlYWQiOjMwMDAwMDAwMDAwMCwidXBkYXRlIjoxODAwMDAwMDAwMDAwfX0=",
          "dependencies": [
            "azurerm_policy_definition.custom_rg_location_policy",
            "data.azurerm_client_config.current"
          ]
        }
      ]
    }
  ],
  "check_results": [
    {
      "object_kind": "var",
      "config_addr": "var.enforcement_mode",
      "status": "pass",
      "objects": [
        {
          "object_addr": "var.enforcement_mode",
          "status": "pass"
        }
      ]
    }
  ]
}
